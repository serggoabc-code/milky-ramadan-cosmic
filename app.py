import streamlit as st
import google.generativeai as genai

# --- –ù–ê–°–¢–†–û–ô–ö–ò –°–¢–†–ê–ù–ò–¶–´ ---
st.set_page_config(page_title="Milky School AI", page_icon="ü•õ")

st.title("ü•õ Milky School: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ó–∞–¥–∞–Ω–∏–π")
st.subheader("–ö–æ—Å–º–∏—á–µ—Å–∫–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –Ω–∞ –†–∞–º–∞–¥–∞–Ω üöÄ")

# --- –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö GOOGLE AI (–ú–û–ó–ì) ---
# –≠—Ç–∞ —á–∞—Å—Ç—å –∏—â–µ—Ç –≤–∞—à API –∫–ª—é—á –≤ —Å–µ–∫—Ä–µ—Ç–∞—Ö Streamlit
try:
    genai.configure(api_key=st.secrets["GOOGLE_API_KEY"])
except:
    st.error("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–æ–±–∞–≤—å—Ç–µ GOOGLE_API_KEY –≤ —Å–µ–∫—Ä–µ—Ç—ã Streamlit!")
    st.stop()

# --- –í–ê–® –ü–†–û–ú–ü–¢ (–ò–ù–°–¢–†–£–ö–¶–ò–Ø) ---
# –ú—ã –≤—Å—Ç–∞–≤–ª—è–µ–º –≤–∞—à —Ç–µ–∫—Å—Ç —Å—é–¥–∞ —Ç–æ—á—å-–≤-—Ç–æ—á—å
SYSTEM_INSTRUCTION = """
**–†–û–õ–¨:** –¢—ã ‚Äî ¬´–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –†–∞–±–æ—á–∏—Ö –¢–µ—Ç—Ä–∞–¥–µ–π Milky School¬ª. –¢–≤–æ—è —Ü–µ–ª—å ‚Äî —Å–æ–∑–¥–∞–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ä–∞–∑–≤–∏–≤–∞—é—â–∏–µ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –¥–µ—Ç–µ–π –Ω–∞ –†–∞–º–∞–¥–∞–Ω, –∞–¥–∞–ø—Ç–∏—Ä—É—è —Ñ–∏—Ä–º–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å —à–∫–æ–ª—ã –ø–æ–¥ –Ω–æ–≤—É—é —Ç–µ–º—É ¬´–ö–û–°–ú–ò–ß–ï–°–ö–û–ï –ü–£–¢–ï–®–ï–°–¢–í–ò–ï¬ª.

**–¢–í–û–Ø –ë–ê–ó–ê –ó–ù–ê–ù–ò–ô (–°—Ç–∏–ª—å Milky School):**
–¢—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (—á–∞—Å—Ç–∏ 1, 2, 3). –¢—ã –∑–Ω–∞–µ—à—å, —á—Ç–æ:
- **–¢–æ–Ω:** –í–µ—Å–µ–ª—ã–π, –æ–±–æ–¥—Ä—è—é—â–∏–π, –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Ä–µ–±–µ–Ω–∫—É ‚Äî ¬´–ú–∏–ª–∫–æ–ª–µ–Ω–æ–∫¬ª, —Ñ—Ä–∞–∑—ã —Ç–∏–ø–∞ ¬´–¢—ã –≥–æ—Ç–æ–≤?¬ª, ¬´–£—Ä–∞!¬ª, ¬´–ü–æ–ª–µ—Ç–µ–ª–∏!¬ª.
- **–ü–µ—Ä—Å–æ–Ω–∞–∂–∏:** –ú–∏–ª–∫–∏ (–ø–∞–∫–µ—Ç –º–æ–ª–æ–∫–∞) –∏ –ü–µ—á–µ–Ω—å–∫–∞.
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:** –í–º–µ—Å—Ç–æ ¬´–û—Å—Ç—Ä–æ–≤–æ–≤¬ª —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ–º ¬´–ü–ª–∞–Ω–µ—Ç—ã¬ª –∏–ª–∏ ¬´–ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏¬ª.
- **–í–∏–∑—É–∞–ª:** –ß–µ—Ç–∫–∏–µ –∫–æ–Ω—Ç—É—Ä—ã, –≤–µ–∫—Ç–æ—Ä–Ω—ã–π —Å—Ç–∏–ª—å, —Ä–∞—Å–∫—Ä–∞—Å–∫–∏ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π.

**–ê–õ–ì–û–†–ò–¢–ú –†–ê–ë–û–¢–´ (–ö–∞–∫ –æ—Ç–≤–µ—á–∞—Ç—å):**
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç —Ç–∏–ø –∑–∞–¥–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–õ–∞–±–∏—Ä–∏–Ω—Ç¬ª, ¬´–ö—Ä–æ—Å—Å–≤–æ—Ä–¥¬ª, ¬´–†–∞—Å–∫—Ä–∞—Å–∫–∞¬ª, ¬´–õ–æ–≥–∏–∫–∞¬ª), —Ç—ã –¥–æ–ª–∂–µ–Ω —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—É—é –ö–ê–†–¢–û–ß–ö–£ –ó–ê–î–ê–ù–ò–Ø, —Å–æ—Å—Ç–æ—è—â—É—é –∏–∑ 4 —á–∞—Å—Ç–µ–π:

1. **–ö–û–ù–¶–ï–ü–¶–ò–Ø –ò –ó–ê–ì–û–õ–û–í–û–ö:**
   - –ü—Ä–∏–¥—É–º–∞–π –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, —Å–º–µ—à–∏–≤–∞—è –ö–æ—Å–º–æ—Å –∏ –ò—Å–ª–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–ü–ª–∞–Ω–µ—Ç–∞ –°–∞–±—Ä¬ª, ¬´–¢—É–º–∞–Ω–Ω–æ—Å—Ç—å –ü–æ—Å—Ç–∞¬ª, ¬´–†–∞–∫–µ—Ç–∞ –¢–∞—Ä–∞–≤–∏—Ö¬ª).

2. **–¢–ï–ö–°–¢ –ó–ê–î–ê–ù–ò–Ø (–î–ª—è —Ä–µ–±–µ–Ω–∫–∞, –Ω–∞ —Ä—É—Å—Å–∫–æ–º):**
   - –ù–∞–ø–∏—à–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ —Å—Ç–∏–ª–µ Milky School.
   - –î–æ–±–∞–≤—å –∫–æ—Ä–æ—Ç–∫–∏–π –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–∫—Ç –∏–ª–∏ —Ö–∞–¥–∏—Å, —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –¥–ª—è –¥–µ—Ç–µ–π.

3. **–ú–ï–•–ê–ù–ò–ö–ê (–õ–æ–≥–∏–∫–∞ –∑–∞–¥–∞–Ω–∏—è):**
   - –î–ª—è –õ–∞–±–∏—Ä–∏–Ω—Ç–æ–≤: –¢–æ—á–∫–∞ —Å—Ç–∞—Ä—Ç–∞, –¢–æ—á–∫–∞ —Ñ–∏–Ω–∏—à–∞, –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è (–≥—Ä–µ—Ö–∏/–ø–ª–æ—Ö–æ–µ), –ë–æ–Ω—É—Å—ã/–¢–æ–ø–ª–∏–≤–æ (–±–ª–∞–≥–∏–µ –¥–µ–ª–∞).
   - –î–ª—è –ü–æ–∏—Å–∫–∞ —Å–ª–æ–≤/–ö—Ä–æ—Å—Å–≤–æ—Ä–¥–æ–≤: –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞.
   - –î–ª—è "–°–æ–µ–¥–∏–Ω–∏ –ø–∞—Ä—ã": –°–ø–∏—Å–æ–∫ –ø–∞—Ä (–ê - –ë).
   - –î–ª—è –†–∞—Å–∫—Ä–∞—Å–æ–∫ –ø–æ –∫–æ–¥–∞–º: –ö–∞–∫–æ–π —Ü–∏—Ñ—Ä–µ –∫–∞–∫–æ–π —Ü–≤–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç.

4. **–ü–†–û–ú–ü–¢ –î–õ–Ø –ò–õ–õ–Æ–°–¢–†–ê–¶–ò–ò (–ù–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º, –¥–ª—è Midjourney):**
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
   - –°—Ç–∏–ª—å: "Black and white coloring page for kids, thick vector lines, cute cartoon style, Milky carton character in space suit, simple stars/planets background".

**–°–¢–†–û–ì–ò–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø:**
- **–ë–µ–∑ –ª–∏—Ü:** –ï—Å–ª–∏ —É–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –ü—Ä–æ—Ä–æ–∫–∏ –∏–ª–∏ –ê–Ω–≥–µ–ª—ã, –ù–ò–ö–û–ì–î–ê –Ω–µ –æ–ø–∏—Å—ã–≤–∞–π –∏—Ö –ª–∏—Ü–∞ –∏–ª–∏ –æ–±–ª–∏–∫. –ò—Å–ø–æ–ª—å–∑—É–π —Å–∏–º–≤–æ–ª—ã (–°–≤–µ—Ç, –ö–Ω–∏–≥–∞, –ö–æ—Ä–∞–±–ª—å, –ö—Ä—ã–ª–æ).
- **–¢–æ—á–Ω–æ—Å—Ç—å:** –ò—Å–ª–∞–º—Å–∫–∏–µ —Ñ–∞–∫—Ç—ã –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—É–Ω–Ω–∏—Ç—Å–∫–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.
- **–Ø–∑—ã–∫:** –í–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Ç–µ—Ç—Ä–∞–¥–∏ ‚Äî –Ω–∞ —Ä—É—Å—Å–∫–æ–º. –ü—Ä–æ–º–ø—Ç –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ ‚Äî –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º.
"""

# --- –ù–ê–°–¢–†–û–ô–ö–ê –ú–û–î–ï–õ–ò ---
model = genai.GenerativeModel(
    model_name="gemini-1.5-flash", # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±—ã—Å—Ç—Ä—É—é –º–æ–¥–µ–ª—å
    system_instruction=SYSTEM_INSTRUCTION
)

# --- –ò–ù–¢–ï–†–§–ï–ô–° (–ß–¢–û –í–ò–î–ò–¢ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨) ---
task_request = st.text_area("–ö–∞–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –Ω—É–∂–Ω–æ –ø—Ä–∏–¥—É–º–∞—Ç—å?", 
                           placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –õ–∞–±–∏—Ä–∏–Ω—Ç –ø—Ä–æ –ù–æ—á—å –ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–ª–∏ –ö—Ä–æ—Å—Å–≤–æ—Ä–¥ –ø—Ä–æ –ò—Ñ—Ç–∞—Ä",
                           height=100)

# –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞
if st.button("üöÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ó–∞–¥–∞–Ω–∏–µ", type="primary"):
    if not task_request:
        st.warning("–ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ–º—É –∑–∞–¥–∞–Ω–∏—è!")
    else:
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—Ä—É—Ç–∏–ª–∫—É –ø–æ–∫–∞ –¥—É–º–∞–µ—Ç
        with st.spinner("–ú–∏–ª–∫–∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å —Ü–µ–Ω—Ç—Ä–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è..."):
            try:
                response = model.generate_content(task_request)
                st.markdown(response.text)
                st.success("–ì–æ—Ç–æ–≤–æ! –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –≤—ã—à–µ.")
            except Exception as e:
                st.error(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}")
